!function(t){"function"==typeof define&&define.amd?define(["knockout"],t):t(ko)}(function(t){t.observableArray.fn.pushAll=function(a){var e=this();return this.valueWillMutate(),t.utils.arrayPushAll(e,a),this.valueHasMutated(),this},t.components.register("ko-table",{viewModel:function(a){var e=this;e.currentPage=t.observable(1);var n=null;if(e.listKeys=t.observableArray([]),t.isObservable(a.list)||Array.isArray(a.list))e.list=a.list;else{$.whenall=function(t){return $.when.apply($,t)},e.list=t.observableArray([]),e.currentPage.subscribe(function(t){console.log(t),e.lazyloadData()});a.list(e.currentPage(),a.options.pageRecords).then(function(t){e.list(t),e.lazyloadData()})}e.lazyloadData=function(){var t,r=[],o=e.currentPage();for(n?t=3-(n-o):(t=3,n=1),console.log("fetched till: "+n),i=1;i<=t;i++)r.push(a.list(n+i,a.options.pageRecords));console.log(r),$.whenall(r).then(function(){var t;if("string"==typeof arguments[1])e.list.pushAll(arguments[0]),t=1;else for(t=0;t<arguments.length;t++)e.list.pushAll(arguments[t][0]);n+=t})},e.filter={},e.ifFilter=function(t){return t.hasOwnProperty("filter")&&t.filter?!0:!1},a.hasOwnProperty("options")&&(e.options=a.options,a.options.hasOwnProperty("columns")?t.utils.arrayForEach(a.options.columns,function(a){e.ifFilter(a)&&(e.filter[a.key]=t.observable(""))}):t.isObservable(a.list)||Array.isArray(a.list)?(e.listKeys=Object.keys(e.list()[0]),console.log(e.listKeys)):e.list.subscribe(function(a){var i=[];"added"===a[0].status&&0===a[0].index&&(console.log("yay, I Ran"),i=Object.keys(a[0].value),t.utils.arrayForEach(i,function(t){e.listKeys.push(t)}))},null,"arrayChange")),e.getWidth=function(t){return t.hasOwnProperty("width")?t.width:""},e.getTableClass=function(){return a.options.hasOwnProperty("tableClass")?a.options.tableClass:""},e.totalPages=t.computed(function(){return Math.ceil(e.list().length/a.options.pageRecords)}),e.setCurrentPage=function(t){e.currentPage(t)},e.gotoFirst=function(){e.currentPage(1)},e.gotoLast=function(){e.currentPage(e.totalPages())},e.currentPaginationList=t.computed(function(){var t=e.currentPage/4%1===0?e.currentPage():e.currentPage()-1,a=4*Math.floor(t/4),i=a+5;i>e.totalPages()&&(i=e.totalPages()+1);for(var n=[],r=a+1;i>r;r++)n.push(r);return n}),e.gotoNextPagination=function(){var t=e.currentPage(),a=5*Math.floor(t/5);0===a&&a++,e.currentPage(a+4)},e.filteredItems=t.computed(function(){return t.utils.arrayFilter(e.list(),function(a){for(var i in e.filter){var n;n=t.isObservable(a[i])?a[i]():a[i];var r=e.filter[i]();if(r.length>0&&n.toLowerCase().indexOf(r)<0)return!1}return!0})}),e.pageList=t.computed(function(){if(a.options.hasOwnProperty("pageRecords")){var t=a.options.pageRecords,i=(e.currentPage()-1)*t,n=i+t;return console.log("begin:"+i+" end:"+n),console.log(e.filteredItems().slice(i,n)),e.filteredItems().slice(i,n)}return e.filteredItems()})},template:'<table style="width:100%" data-bind="css:getTableClass()">                <thead>                    <div data-bind="if: options.hasOwnProperty(&quot;columns&quot;)">                        <tr data-bind="foreach:options.columns">                            <th data-bind="attr:{width:$parent.getWidth($data)}">                                <span data-bind="text: $data.hasOwnProperty(&quot;name&quot;)?$data.name:$data.key"></span></th>                        </tr>                        <tr data-bind="foreach:options.columns">                            <th>                                <div data-bind="if : $parent.ifFilter($data)">                                    <input data-bind="textInput: $parent.filter[$data.key]">                                <div>                            </th>                        </tr>                    </div>                    <div data-bind="if: !options.hasOwnProperty(&quot;columns&quot;)">                        <tr data-bind="foreach:listKeys">                            <th>                                <span data-bind="text: $data"></span></th>                        </tr>                    </div>                </thead>                <div data-bind="if: options.hasOwnProperty(&quot;columns&quot;)">                    <tbody data-bind="foreach: pageList">                        <tr data-bind="foreach: $parent.options.columns">                            <td data-bind="text: $parentContext.$data[$data.key]"></td>                        </tr>                    </tbody>                </div>                <div data-bind="if: !options.hasOwnProperty(&quot;columns&quot;)">                    <tbody data-bind="foreach: pageList">                        <tr data-bind="foreach: $parent.listKeys">                            <td data-bind="text: $parentContext.$data[$data]"></td>                        </tr>                    </tbody>                </div>            </table>            <div data-bind="if: options.hasOwnProperty(&quot;pageRecords&quot;)">                <ul class="pagination pull-right">                    <li>                        <a href="javascript:void(0)" data-bind="click: function(){gotoFirst()}" aria-label="Previous">                        <span aria-hidden="true">&laquo;</span></a>                    </li>                    <!-- ko foreach: currentPaginationList -->                    <li data-bind="css:{active:$data==$parent.currentPage()}"><a href="javascript:void(0)" data-bind="text:$data,click: function(){$parent.setCurrentPage($data)}"></a></li>                    <!-- /ko -->                    <!-- ko if: currentPaginationList().slice(0).pop()!=totalPages() -->                    <li><a href="javascript:void(0)" data-bind="click:function(){gotoNextPagination()}">...</a></li>                    <!-- /ko -->                    <li>                        <a href="javascript:void(0)" data-bind="click: function(){gotoLast()}" aria-label="Next">                    <span aria-hidden="true">&raquo;</span>                    </a>                    </li>                </ul>            </div>'})});