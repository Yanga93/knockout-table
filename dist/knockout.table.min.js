!function(t){"function"==typeof define&&define.amd?define(["knockout"],t):t(ko)}(function(t){t.observableArray.fn.pushAll=function(a){var e=this();return this.valueWillMutate(),t.utils.arrayPushAll(e,a),this.valueHasMutated(),this},t.bindingHandlers.selectable={init:function(a,e,n,i,r){var o=e(),s=t.unwrap(o);s&&(-1!=r.$parent.selectedRows.indexOf(r.$data)&&$(a).addClass("selected"),$(a).click(function(){$(this).toggleClass("selected"),r.$parent.selectedRows.indexOf(r.$data)<0?r.$parent.selectedRows.push(r.$data):r.$parent.selectedRows.remove(r.$data),console.log(r.$parent.selectedRows())}))},update:function(t,a,e,n,i){}},t.components.register("ko-table",{viewModel:function(a){var e=this;e.currentPage=t.observable(1);var n=null;if(e.selectedRows=t.observableArray([]),e.listKeys=t.observableArray([]),t.isObservable(a.list)||Array.isArray(a.list))e.list=a.list;else{$.whenall=function(t){return $.when.apply($,t)},e.list=t.observableArray([]),e.currentPage.subscribe(function(t){e.lazyloadData()});a.list(e.currentPage(),a.options.pageRecords).then(function(t){e.list(t),e.lazyloadData()})}e.lazyloadData=function(){var t,r=[],o=e.currentPage();for(n?t=3-(n-o):(t=3,n=1),i=1;i<=t;i++)r.push(a.list(n+i,a.options.pageRecords));$.whenall(r).then(function(){var t;if("string"==typeof arguments[1])e.list.pushAll(arguments[0]),t=1;else for(t=0;t<arguments.length;t++)e.list.pushAll(arguments[t][0]);n+=t})},e.filter={},e.ifFilter=function(t){return t.hasOwnProperty("filter")&&t.filter?!0:!1},a.hasOwnProperty("options")&&(e.options=a.options,a.options.hasOwnProperty("columns")?t.utils.arrayForEach(a.options.columns,function(a){e.ifFilter(a)&&(e.filter[a.key]=t.observable(""))}):t.isObservable(a.list)||Array.isArray(a.list)?(e.listKeys=Object.keys(e.list()[0]),console.log(e.listKeys)):e.list.subscribe(function(a){var n=[];"added"===a[0].status&&0===a[0].index&&(console.log("yay, I Ran"),n=Object.keys(a[0].value),t.utils.arrayForEach(n,function(t){e.listKeys.push(t)}))},null,"arrayChange")),e.getWidth=function(t){return t.hasOwnProperty("width")?t.width:""},e.getTableClass=function(){return a.options.hasOwnProperty("tableClass")?a.options.tableClass:""},e.totalPages=t.computed(function(){return Math.ceil(e.list().length/a.options.pageRecords)}),e.setCurrentPage=function(t){e.currentPage(t)},e.gotoFirst=function(){e.currentPage(1)},e.gotoLast=function(){e.currentPage(e.totalPages())},e.currentPaginationList=t.computed(function(){var t=e.currentPage/4%1===0?e.currentPage():e.currentPage()-1,a=4*Math.floor(t/4),n=a+5;n>e.totalPages()&&(n=e.totalPages()+1);for(var i=[],r=a+1;n>r;r++)i.push(r);return i}),e.gotoNextPagination=function(){var t=e.currentPage(),a=5*Math.floor(t/5);0===a&&a++,e.currentPage(a+4)},e.filteredItems=t.computed(function(){return t.utils.arrayFilter(e.list(),function(a){for(var n in e.filter){var i;i=t.isObservable(a[n])?a[n]():a[n];var r=e.filter[n]();if(r=r.toLowerCase(),r.length>0&&i.toString().toLowerCase().indexOf(r)<0)return!1}return!0})}),e.pageList=t.computed(function(){if(a.options.hasOwnProperty("pageRecords")){var t=a.options.pageRecords,n=(e.currentPage()-1)*t,i=n+t;return e.filteredItems().slice(n,i)}return e.filteredItems()}),e.getTemplate=function(t,a){return t.hasOwnProperty("html")&&t.html?t.key:"textTmpl"}},template:'<table style="width:100%" data-bind="css:getTableClass()">                <thead>                    <div data-bind="if: options.hasOwnProperty(&quot;columns&quot;)">                        <tr data-bind="foreach:options.columns">                            <th data-bind="attr:{width:$parent.getWidth($data)},css:$data.class">                                <span data-bind="text: $data.hasOwnProperty(&quot;name&quot;)?$data.name:$data.key"></span></th>                        </tr>                        <tr data-bind="foreach:options.columns">                            <th data-bind="css:$data.class">                                <div data-bind="if : $parent.ifFilter($data)">                                    <input data-bind="textInput: $parent.filter[$data.key]">                                <div>                            </th>                        </tr>                    </div>                    <div data-bind="if: !options.hasOwnProperty(&quot;columns&quot;)">                        <tr data-bind="foreach:listKeys">                            <th>                                <span data-bind="text: $data"></span></th>                        </tr>                    </div>                </thead>                <div data-bind="if: options.hasOwnProperty(&quot;columns&quot;)">                    <tbody data-bind="foreach: pageList">                        <tr data-bind="foreach: $parent.options.columns,selectable:$parent.options.selectable">                                <td data-bind="template:{name: $parents[1].getTemplate($data),data:{row:$parentContext.$data,key:$data.key}},css:$data.class"></td>                        </tr>                    </tbody>                </div>                <div data-bind="if: !options.hasOwnProperty(&quot;columns&quot;)">                    <tbody data-bind="foreach: pageList">                        <tr data-bind="foreach: $parent.listKeys,selectable:$parent.options.selectable">                            <td data-bind="text: $parentContext.$data[$data]"></td>                        </tr>                    </tbody>                </div>            </table>            <div data-bind="if: options.hasOwnProperty(&quot;pageRecords&quot;)">                <ul class="pagination pull-right">                    <li>                        <a href="javascript:void(0)" data-bind="click: function(){gotoFirst()}" aria-label="Previous">                        <span aria-hidden="true">&laquo;</span></a>                    </li>                    <!-- ko foreach: currentPaginationList -->                    <li data-bind="css:{active:$data==$parent.currentPage()}"><a href="javascript:void(0)" data-bind="text:$data,click: function(){$parent.setCurrentPage($data)}"></a></li>                    <!-- /ko -->                    <!-- ko if: currentPaginationList().slice(0).pop()!=totalPages() -->                    <li><a href="javascript:void(0)" data-bind="click:function(){gotoNextPagination()}">...</a></li>                    <!-- /ko -->                    <li>                        <a href="javascript:void(0)" data-bind="click: function(){gotoLast()}" aria-label="Next">                    <span aria-hidden="true">&raquo;</span>                    </a>                    </li>                </ul>            </div>            <script id="textTmpl" type="text/html">               <div data-bind="text: row[key]"></div>            </script>'})});